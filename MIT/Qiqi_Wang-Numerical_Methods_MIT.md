# Qiqi Wang-Numerical Methods MIT

> <https://www.youtube.com/playlist?list=PLwXscOMmh_DJaSIE_RtDO2FDyey5wAkox>

## 1. MIT 2.097/6.339/16.920 部分微分方程数值方法 第一堂课:简介

这门课将介绍四种解决部分微分方程的数值方法:

- 有限差分法
- 有限体积法
- 有限元素法(也称为积分元素法)
- 边界元素法

在此之前,将学习直接和隐式的解法,这是将微分方程离散化后的结果,即Ordinary 微分方程或更简单的代数方程系统。

还将学习如何利用这些方法对离散后的大型方程系统进行求解。这在PDs中的系统规模比其它应用通常更大。

课程将重点介绍如何开发代码来求解不同类型的方程。

将学习的主题包括:

- 非线性方程求解
- 不同方法的优缺点以及在何种情况下使用
- 网络问题求解

部分微分方程在许多科学工程领域有广泛应用,如:

- 气象预测
- 航天飞行器设计
- 消防设施布局

通过数值模拟,可以有效节约成本、缩短研发周期,也可能避免实验中的安全隐患。合理利用这些方法,对科技发展贡献很大。

## 2. MIT 2.097/6.339/16.920 部分微分方程数值方法 第一堂课:课程格式

这门课没有考试和作业,而是重点在于项目学习。老师将给出一些真实问题,需要学生独立完成编码并调试求解。

这对于训练解决问题的能力很有效。对没有编程经验的同学,这门课让你学到的不仅是数值方法,还包括编码和调试技能。即使有经验,求解数值方程也需要不同的思路。

这门课的 prerequistes 包括:

- 线性代数能力要很强
- 普通微分方程的理论和数值解法
- 熟悉MATLAB编程

将组成团队进行项目学习。已经发布了个人评估项目,需要及时完成并提交,以便为后续团队项目配对组合队友。

所有项目成果都需要通过学生独立编码并在MATLAB中运行调试得到。并且遵守Stellar平台上的合作政策,禁止在团队成员或个人之间分享源代码。但鼓励通过讨论交流求助。

## 3. MIT 部分微分方程数值方法 第一堂课:对流 diffusion 方程

这节课中介绍了一个典型的对流 diffusion 方程:

∂u/∂t + u∂u/∂x = κ∂^2u/∂x^2

它描述了变化随时间和空间的函数 u。

这是一个线性偏微分方程。给出边界条件和初始条件后,可以通过数值算法求解它内部区域的解。

使用 MATLAB 模拟了不同参数下的解。发现:

- κ大于0时,解会随时间消散;κ小于0时,解会向无限趋近。

- u大于0时,解向右运动;u小于0时,向左运动。

- κ为0时,解会保持形状不变,仅根据u的正负方向移动。

这可以解释方程的物理行为。数值结果也可以通过这种理解进行验证。

这提供了一个很好的例子,用于理解和实现各种数值方法,如有限差分法、有限体积法和有限元素法等。帮助学习如何处理边界条件和初始条件问题。

## 4. MIT 部分微分方程数值方法 第一堂课:热方程

这节课中,教师开始介绍热方程作为对流-扩散方程的一个特例:

∂u/∂t = κ∂^2u/∂x^2

当u等于0时,它描述了一个固体材料内部温度随时间和空间变化的过程。

教师使用MATLAB模拟了不同初值条件下的解。结果表明,随着时间,任意初值条件下的温度分布将变得均匀。这说明热导使热能从高温区域传导到低温区域,实现热平衡。

 thermal方程的特点是它属于偏微分方程中称为“椭圆型”的类,从空间图表示其特征域为整个空间。这与“光滑型”方程不同,其特征域仅限于初值条件影响范围附近的区域。

教师还介绍了函数离散化的两种方法:有限差分法和有限体积法。它们分别采用网格点的值和控体内函数平均值来近似连续函数。

教师表示以后会详细学习高阶精度方法。高阶意味着重复网格解析率时,解的误差下降速度高于线性。最后强调了离散化方法与高阶方法的区分。

## 5. MIT 部分微分方程数值方法 第一堂课:热方程的有限差分

教师开始介绍如何将热方程利用有限差分法离散成网格节点的值:

首先把空间域划分为等间距的网格点,函数值只存储在这些网格点上。这样将函数U(x,t)表示为时间t下各网格点的值组成的矢量函数U(t)。

然后利用泰勒级数展开,将邻近网格点函数值表示为当前点函数值加上导数项。篇幅精确地推导了二阶导数的有限差分近似公式:

U''(x)≈(U(x+Δx)-2U(x)+U(x-Δx))/Δx^2

将这个近似代入热方程,就将偏微分方程转化为关于时间的网格点函数值矢量的一组常微分方程。

教师详细说明了利用前进欧拉法解这组常微分方程的算法过程。并提到还有后退欧拉法、梯形法等常微分方程求解方法。

最后教师从泰勒级数的层面解释了有限差分近似的精度取决于Δx,近似误差随Δx的缩小而快速收敛到零的特点。高阶有限差分近似的精度能更快收敛到零。

## 6. MIT 部分微分方程数值方法 第一堂课:热方程的有限差分解法

教师开始讲解边界条件。对边界网格点提出了特殊处理:

- 给出边界函数值后,第一个网格点的值直接等于边界函数值。

- 时间导数近似只与相邻两个内网格点有关。

然后用线性代数形式表达有限差分式:du/dt=Au+B。

教师详细解释了A矩阵和B向量的形状。A矩阵是三对角矩阵,B向量只在边界位置有值。

进一步介绍欧拉法和后退欧拉法解此常微分方程组。欧拉法是显式的,后退欧拉法需要求逆矩阵是隐式的。

后退欧拉法在数值稳定性上优于欧拉法,允许更大的时间步长。但都只具有第一阶时间精度。

数值误差与时间步长和网格间距都有关。提到较高阶时间 discrectization 方式,如梯形法和Runge-Kutta方法可提高时间精度。

最后强调求解PDE问题时,时间和空间离散化方案的顺序亦影响最终精度。

## 7. MIT 2.097/6.339/16.920 部分微分方程数值方法 第一堂课:项目0

教师分亲项目0要求:

- 要求编写Matlab函数heat_1D.m,输入参数包括时间步长Δt,左右边界条件,初值。

- 函数需返回域中间位置的解。

- 另外需提供导数的有限差分格式以及边界条件的处理方法。

- 提交需提供PDF文件,代码单独归档。要求文字清晰打印或拍摄。

项目不计入总成绩,目的是了解学生水平,以便安排合作伙伴。

教师提醒监听生如果想参与也可以与另一监听生配对。同时AnswerStudents是否为真正参与者的疑问。

总体上,该项目要求实现一维热定例问题的简单数值解法,以验收学生编程基础和安排合作。

## 8. MIT 部分微分方程数值方法 第二堂课:复习与泊松方程的有限差分

教师复习上节课讲解一维热方程的有限差分解法:

- 空间与时间离散化,建立网格与时间步长。

- 使用二阶中心差分近似导数,建立明暗矩阵形式的线性方程组。

然后讲解如何应用同样的有限差分方法来解泊松方程:

- 泊松方程为椭圆型方程,独立于时间。

- 该方程可看作热方程在稳态下的形式,右侧增加一个源项。

- 使用相同的差分格式来近似源项和指数项。

- 离散化方程也变为线性系统Ax=b形式,使用MATLAB反解解决。

最后强调求解椭圆型方程直接 solving线性系统更稳定,而非求逆矩阵。

总体上讲解如何利用已有的有限差分格式,来解其他类型的偏微分方程。

## 9. MIT 部分微分方程数值方法 第二堂课:泄波方程的有限差分

教师开始介绍如何对泄波方程进行有限差分:

- 泄波方程为:∂^2u/∂t^2 = ∂^2u/∂x^2, 描述一维空间中波动传播。

- 可以求解出波函数u=f(x-t)或u=f(x+t)作为方程的解,说明波能向正负方向传播。

- 将二阶时间导数转化为一阶时间导数的形式:设V=∂u/∂t, 则∂u/∂t=V, ∂V/∂t=∂^2u/∂x^2

- 使用中心差分近似∂^2u/∂x^2,得到系统∂u/∂t=V, ∂V/∂t=(u(i+1)-2u(i)+u(i-1))/Δx^2

- 离散化后仍可使用OD45等数值积分法求解,但解向量长度增长为原来的两倍。

总体上说明如何将高阶时间导数的泄波方程,转化为等价的一阶系统,并用已知的空间差分方法求解。区分特征在于波传播以有限速度。

## 10. MIT 部分微分方程数值方法 第二堂课:截断误差(一)

教师开始介绍有限差分近似的截断误差:

- 截断误差定义为有限差分近似和实际二阶函数之间的差异。

- 用泰勒级数展开近邻节点函数,保留足够项使首次非零项出现。

- 对中心差分求二阶导数展开泰勒级数,各阶导数项相加后,除去Δx之外的项都会消掉。

- 段误差的主项是Δx^2除以12乘宏观函数的四阶导数。

- 更光滑函数四阶导数较小,相同Δx下截断误差也较小;振荡函数相反。

- 要保持相同截断误差,振荡函数需要更细的网格。

- 近似不同阶导数,截断误差与采用的数值差分模式有关,更高复杂度模式误差会小,但算法也更复杂。

- 截断误差、稳定性和计算复杂度之间总存在折中。

## 11. MIT 部分微分方程数值方法 第二堂课:截断误差(二)

教师开始介绍如何通过绘图验证有限差分近似的阶数:

- 在对数坐标轴上绘出不同Δx下的截断误差,如果误差随Δx的二次方下降,表示是二阶收敛度。

- 误差随Δx下降越快,近似的阶数就越高。

- 实际误差曲线上可能有一定偏差,但在Δx足够小时应趋于理论预测曲线。

- 对不同函数,初期误差曲线可能不同,但阶数由Δx趋于零时的斜率决定。

教师指出,这种方法可以验算有限差分近似代码是否实现正确。

教师还提到,这种前向误差分析需要假设解析解,而后向误差分析著眼于数值解本身,给出误差上限,是一种更通用的方法。

## 12. MIT 部分微分方程数值方法 第二堂课:构建有限差分近似

教师开始介绍如何通过控制误差来构建一阶或高阶的有限差分近似公式。

- 首先需要给出近似公式的一般形式,只涉及相邻格点的函数值。

- 然后利用泰勒展开给出近似误差与真实解之间的关系。

- 控制近似误差中的各阶导数项为零,从而得到近似公式中的各常数。

- 一阶近似需要两个方程两个未知量,可以得到前向差分或后向差分。

- 二阶或更高阶近似需要更多未知量,同时利用更多导数关系得到更多方程。

- 直接解方程得到近似公式,也可以设置矩阵方程由MATLAB求解。

教师给出了一阶导数的二阶中心差分公式构成过程作为示例。边界点的近似需要另外考虑。

后面会讨论用有限差分近似解数值方法时,还需要结合微分方程的稳定性问题进行考虑。

## 13. MIT 部分微分方程数值方法 第二堂课:解误差分析

教师开始介绍如何分析有限差分解的误差。

- 将椭圆型微分方程作为例子,分析实际解u和数值解uhat之间的误差ε。

- 将误差ε等价表示为 operatorA作用在真实解u上的误差τ。

- 利用泰勒展开,求出operatorA作用在真实解u上的表达式,即截断误差τ。  

- 建立τ与ε之间的关系ε=A^-1τ,表明误差ε取决于截断误差τ和矩阵A的性质。

- 引入矩阵A的范数定义,范数反映解ε与截断误差τ之间的最大比值。

- 稳定性要求范数与Δx无关,即Δx趋于0时,ε与τ趋于同样的收敛顺序。

- 一致性(τ收敛于0)与稳定性共同确保解ε也收敛于0,从而实现求解的一致收敛。

- 常见问题椭圆型方程具有天然稳定性,因此一致收敛。边界值问题稳定性需另外考虑。

教师解释完误差分析理论后回答问题,强调稳定性在数值分析中重要性。

## 14. MIT 部分微分方程数值方法 第二堂课:椭圆方程稳定性分析

教师继续介绍矩阵A的范数与稳定性分析。

- 矩阵A是对称矩阵,其特征值和特征向量都为实数,特征向量互相正交。

- 将向量W用特征向量作为基转化为特征值坐标系表达。分析Aw与W范数比值。

- Aw与W范数比值取决于最小特征值,因此需求最小特征值不会随Δx趋近0而趋近0。

- 椭圆方程数值解采用有限差分,矩阵A为离散二阶导数近似算子。

- 通过求解,A矩阵特征向量为离散正弦函数,特征值表达式为λk=2(coskπ/n-1)。

- 最小特征值λ1不依赖Δx,意味着A矩阵稳定性不取决Δx,从而确保数值解收敛。

- 稳定性分析表明,椭圆方程采用有限差分方法求解是一致与稳定的,能很好地近似真实解。

教师通过例子解释完矩阵稳定性相关概念,回答问题明确特征值分析重要性所在。

## 15. MIT 部分微分方程数值方法 第三堂课:一维椭圆方程稳定性

教师复习前课内容,总结一维椭圆方程稳定性分析方法。

- 解决误差Yi可以表示为误差项τ和矩阵A的逆之间的关系。

- 矩阵A的功率与Δx的关系直接决定了数值解的收敛性。

- 对一维椭圆方程的离散矩阵A,其特征值与特征向量可以表示为离散正弦函数。

- 将函数扩展为泰勒级数,求得A逆范数随Δx的极限,为L2/π2,与Δx无关。

- 表明A矩阵稳定,解决误差随Δx趋于0时收敛,与误差项τ收敛率一致。

- 数值解收敛保证了椭圆方程有限差分方法的一致性与稳定性。

教师回答学生问题,指出解决还取决于边界条件和定义域等问题,但我们关注的主要是Δx细化时数值解的行为。

## 16. MIT 部分微分方程数值方法 第三堂课:一维椭圆方程边界条件

教师总结一维椭圆方程的常见边界条件:

- Dirichlet边界条件(DirichletConditions):解函数值在边界上给定。

- Neumann边界条件(NeumannConditions):解函数派生在边界上给定。如热传导方程中的温度梯度或热通量。

- 例如保温边界对应Dirichlet条件,绝热边界对应Neumann条件,温度梯度为0。

教师给出Neumann边界条件下离散矩阵A的形式:

- 矩阵A除首列外,与Dirichlet边界条件相同。

- 首列采用边界点与第二点的差值除以Δx来近似Neumann边界条件。

- 这样能保证矩阵各项大小一致,有利于数值稳定性。

教师提出混合边界条件,同时包含解函数值和派生项,矩阵形式需要进一步研讨。

最后教师暗示将总结迁移到二维情况,没有更多问题则开始二维讲解。

## 17. MIT 部分微分方程数值方法 第四堂课:二维有限差分映射

教师提出,为采用有限差分方法解决二维方程,需要将物理域映射为计算域。

- 物理域为真实问题域,计算域为矩形域。通过映射,可以将任意物理域对应到计算域。

- 用于举例说明的映射包括:锯齿型映射(C型)、钩型映射,适用于飞机翼等复杂形状。

- 映射定义为:物理坐标(x,y)对应计算坐标(ξ,η),且反向可求。

- 通过链式法则,可将物理域方程转换为计算域方程。如二维泊松方程对应的项包含ξ、η各阶导数。

- 良好映射应减少计算域方程中导数项,或将其置零。

- 映射转换后,问题转化为在计算矩形域内求解方程。这为二维有限差分奠定基础。

- 随后将讨论计算矩形域内方程的有限差分形式及求解方法。

## 18. MIT 部分微分方程数值方法 第四堂课:域映射问答

学生提出疑问:

- 如何确定映射函数?教师表示没有统一方式,需要积累经验和反复尝试。

- 映射能否导致方程变非线性?教师解释,尽管映射本身可能非线性,但最终得到的方程依旧是线性的。

- 是否可以令计算域中的网格间隔随意变小变大?教师表示需要根据物理域中解函数的复杂程度来控制网格。

- 计算域是否一定要保持均匀网格?教师表示虽不一定,但采用均匀网格更容易构建有限差分格式。

- 如何处理计算域与物理域之间网格间隔的比例问题?教师表示好的映射应使解函数在计算域中细细分解析度一致。

- 我们是否直接在物理域上差分化偏微分方程?教师指出我们实际上先在物理域推导出新的方程,然后在计算域对其差分化求解。

## 19. MIT 部分微分方程数值方法 第四堂课:二维Poisson方程的有限差分

教师介绍二维场域的有限差分方法:

1. 使用固定网格Δx和Δy划分参考场域。每点用二维数组U[i,j]存储函数值

2. 拉普拉斯算子采用五点差分公式近似:

    ∂2u/∂x2 ≈ (U[i+1,j]-2U[i,j]+U[i-1,j])/Δx2

    ∂2u/∂y2 ≈ (U[i,j+1]-2U[i,j]+U[i,j-1])/Δy2

3. 将二维数组U[i,j]拉伸为一维向量u以求矩阵形式

4. 矩阵A对角线元素为-(2/Δx2+2/Δy2),上对角线元素为1/Δx2,下对角线元素为1/Δx2

5. 由于五点差分,A矩阵为五对角矩阵形式

6. 每个矩阵块对应一个水平网格线,具有三对角形式,但基于网格存在距离为n点的非零项

7. 解二维Poisson方程等价于求解线性方程组Au=f

教师以例子详细解释了二维场域有限差分的基本原理和矩阵表达形式。

## 20. MIT 部分微分方程数值方法第四堂课:二维有限差分MATLAB演示

教师在MATLAB中构建二维线性方程的矩阵:

1. 设置网格点数n=8,m=10,Δx=0.1,Δy=0.01

2. 初始化80×80大小的零矩阵A

3. 填充矩阵A主对角线元素为-(2/Δx^2+2/Δy^2)

4. 使用双重循环填充上、下对角线元素为1/Δx^2

5. 填充距离n点的非零元素,上对角线元素为1/Δy^2,下对角线元素为1/Δx^2  

6. 矩阵A以8×8块为单位,每块具有三对角形式,并存在间隙

7. 每个矩阵块对应网格中的一条水平线,从起点延伸至终点

8. 使用spy()观察A矩阵的稀疏结构,验证它是一个五对角矩阵

教师通过具体代码演示了如何在MATLAB中构建二维Poisson方程的系数矩阵,并验证了其结构特征。

## 21. MIT 部分微分方程数值方法第五堂课:二维有限差分求解方程

1. 教师回顾上课构建二维场域系数矩阵A的过程

2. 对椭圆方程Au=f进行解答,直接使用MATLAB进行反矩阵计算或迭代求解大矩阵方程

3. 对热传导方程将二阶微分问题转化为一阶微分方程组DU/DT=AU,采用显式或隐式法进行时间离散

4. 采用隐式法(如后向欧拉),每时间步进行矩阵方程的求解以更新解

5. 对波动方程,定义辅助变量V=DU/DT,将问题转化为第一阶微分方程组[DU/DT DV/DT]^T=[A00I]·[U;V]^T

6. 方程组可以使用MATLAB中的OD45或隐式法进行求解

7. 对三类方程,教师详细解释了如何利用有限差分法将问题转化为大矩阵方程的求解问题

8. 本课重点介绍如何运用迭代算法求解这类大型矩阵方程,以实现数值模拟。

## 22. MIT 部分微分方程数值方法第四堂课:Jacobi迭代法简介

1. 线性方程组可以表示为Au=B形式,矩阵A代表系数矩阵,向量B代表右侧项

2. 直接法如Gauss消元法会破坏稀疏矩阵A的结构,计算效率低

3. 迭代法如Jacobi迭代法仅操作非零元,适用于稀疏矩阵,每次迭代更新近似解

4. Jacobi迭代法先将A分解为对角阵D和非对角项L、U,然后求解D×u=B-L×u-U×u

5. 初始化u^0,然后采用u^k=(D)^-1×(B-L×u^(k-1)-U×u^(k-1)))进行迭代

6. 若u^k与u^(k-1)距离趋于0,则找到了解u,满足Au=B

7. 迭代初值可以指定,如解前一时刻解或全0向量;也可以将L和U分开处理

8. Jacobi迭代的收敛性取决于矩阵A的特性,部分矩阵可以迅速收敛找到解

9. 该方法适用于稀疏矩阵,且每次迭代仅访问对角元,时间복杂度短,space复杂度低

## 23. MIT 部分微分方程数值方法第四堂课:Jacobi迭代法在1D和2D泊松方程中的应用

1. Jacobi迭代法将矩阵A分解为对角矩阵D和非对角矩阵L+U,更新解u依赖于上一步解和右端向量B。

2. 对1D泊松方程,A为1/Δx^2的对角矩阵加交替+1/-1的非对角矩阵。Jacobi迭代更新解依赖4个临近节点。

3. 对2D泊松方程,A为1/Δx^2的4个对角线加1的非对角线。Jacobi迭代更新解依赖8个周边节点。

4. 求解过程通过矩阵向量运算表述为邻域节点的线性组合,无需存储全矩阵,称为云数字操作。

5. 当对角元为0时,无法使用Jacobi迭代,可以通过重新排列矩阵行列实现对角元全秩。

6. 迭代停止依据是残差Rk=B-Auk趋近0,需要估计误差范围参考A特征值或条件数。

7. 节点间步长Δx、Δy不同仅改变系数,不影响迭代方程结构与求解过程。

## 24. MIT 部分微分方程数值方法第四堂课:Jacobi迭代法在Matlab中以Lenna图像为例

1. 使用Lenna图像作为2D泊松方程的精确解,将图像像素值除以256标准化到0-1范围。

2. 构建等间距网格,设点间步长为1/129。设边界值恒等0,内点值为图像像素值。

3. 根据离散拉普拉斯算子,求出右端向量B,即A×u。

4. 初始化迭代解u为全0矩阵,设u0。设置迭代更新公式u(k+1)=u(k)-D^(-1)×(Au(k)-B)。

5. 以零初值,进行Jacobi迭代更新计算。每次迭代都更新u,并显示结果比较。

6. 重复迭代1000次后,迭代解u收敛至精确解图像形状。算法实现了2D泊松方程的离散。

7. 迭代过程可观察解的逐步接近精确解,验证Jacobi迭代法的有效性。

## 25. MIT 部分微分方程数值方法第四堂课:Jacobi迭代法MATLAB演示进一步讨论

1. 边界条件设置为零,Jacobi迭代只更新内部点值,实现了零Dirichlet边界条件。

2. 如果知道边界条件值,可在每次迭代后,根据最近内点值更新边界点值。

3. 对角边点,可以取相邻两点平均值作为边界条件。

4. 将二维数组展平为一维数组,需要 explicitly 进行矩阵向量乘法操作时进行。

5. 迭代后解较中间点误差大是Jacobi迭代的通性,对应于迭代矩阵特征值最小的特征向量。

6. 继续迭代后,中间点误差会降低,与精确解趋同。

7. 不同图像,以及不同域形状,采用相同算法,误差分布模式不变。

8. 需要了解Jacobi迭代理论基础,解释其误差特性与迭代收敛速度。

## 26. MIT 部分微分方程数值方法第四堂课:Jacobi迭代法误差分析

1. Jacobi迭代得到的迭代解和精确解之间的误差与隐式差分法收敛定义不同。这里指迭代步k时解与精确解的差。

2. 对迭代解与精确解方程进行减法,得出误差更新公式为ek=R*ek-1,其中R=-D^(-1)*(L+U)。

3. 将R视为迭代矩阵。则ek随k增大时,可表示为R^k*e0。

4. Jacobi迭代收敛的条件是迭代矩阵R所有特征值大小都必须小于1。否则对应特征向量方向的误差将呈指数级增长。

5. 迭代后,误差ek可表示为各特征向量Xi对应系数ai与特征值λi的函数。随k增加,λi值最大者作用最大。

6. 对拉普拉斯算子,λ值接近1的特征向量对应的解最平缓。说明迭代后误差主要来源于这个特征向量方向。

7. 下一次课将从拉普拉斯算子角度解释为何λ最大值对应的解最平缓。

## 28. MIT 部分微分方程数值方法第五堂课:实现Jacobi迭代法

1. Jacobi迭代方法的输入包括初始解和右端项,输出为下一次迭代的解。

2. 先获取解u和右端项B的尺寸,再计算网格间距Δx。

3. 初始化u_next为零矩阵,对内部节点进行迭代:

   u_next_{ij}=(−Δx^2/4)*(B_{ij}-u_{i−1,j}-u_{i+1,j}-u_{i,j−1}-u_{i,j+1}+4u_{ij})

4. 函数重复调用实现多次迭代。

5. 解错误定义为实际解u_exact与迭代解u之间的差。初步迭代误差平缓,经多次迭代后误差更小。

6. 运用迭代函数,以零猜测开始多次迭代,可观察迭代解误差随迭代次数减小的趋势。

7. 识别Jacobi迭代后解误差特征:与实解拉普拉斯算子导数呈平滑关系,表现为实解细节的模糊版本。

## 29. MIT 部分微分方程数值方法第五堂课:调试Jacobi迭代

1. Jacobi迭代后近似解误差呈平滑特征,边界附近会出现明亮区域。

2. 检查i索引迭代范围,应为2至N而非2至N-1。

3. 按零初始化u_next矩阵,每次迭代赋值新解覆盖原解。

4. 验证右端项B构造是否正确,应迭代索引i、j范围为2至N。

5. 使用真实解u_exact构造B,避免使用错误的近似解。

6. Matlab函数传参按值传递,u_next=u不会直接修改原u值。

7. 迭代后解应在边界也显示黑色,现有结果右边框明亮不对称。

8. 检查Jacobi迭代公式和B构造是否有误,以修正边界处理问题。

9. 多次迭代后解应趋向原问题真实解,显示为原图片的平滑版本。

## 30. MIT 部分微分方程数值方法第五堂课:误差方程与Jacobi迭代的特征值分析

1. Jacobi迭代后的近似解误差会趋于平滑,这不仅出于偶然。

2. Jacobi迭代将矩阵D划分为对角线部分和非对角线部分,两个迭代步骤方程左边同时包含B和精确解Uexact。

3. 定义误差E=Uexact-UK,将两个方程相减可得误差规划式DEk+1=R·Ek,其中R取决于D、L和U。

4. 2D拉普拉斯场方程中,R为平均算子,将四周点平均至中心点。

5. R的特征向量为二维正弦波形式,特征值λ为K1和K2函数,λ最大值近1和-1。

6. λ近1模式最平滑,λ近-1模式为网格尺度的振荡,由于R作用将翻转但保幅度。

7. 特征分析解释为什么Jacobi迭代解趋于平滑,但存在最慢衰减模式。

8. 多网格方法利用解平滑特性来加快收敛,需确保误差始终平滑避免最慢模式。

## 31. MIT 部分微分方程数值方法第五堂课:多网格法1 -- 平滑算子(放缓Jacobi迭代)

1. 放缓Jacobi迭代将当前解和Jacobi迭代后的新解进行加权平均:Xk+1= γ*Jacobi(Xk) + (1-γ)*Xk

2. 此操作可让解误差映射到0-1范围内,避免由极小特征值引起的缓慢衰减模式。

3. 放缓系数γ越小,映射范围越小;γ越大,映射范围越宽。

4. 放缓Jacobi迭代保证了任意初值的误差都能平滑地收敛。

5. 多网格法先采用多次放缓Jacobi迭代进行预平滑,然后在较粗网格上求解误差方程。

6. 误差方程解决后的网格再进行后平滑,即再执行几次放缓Jacobi迭代以进一步平滑误差。

7. 平滑算子主要目的是消除解的振荡分量,而非平稳分量。平稳分量可以在粗网格上更高效地处理。

8. MATLAB实现多网格法,首先需要实现放缓Jacobi迭代作为平滑算子。

## 32. MIT 部分微分方程数值方法第五堂课:多网格法2 -- 粗网格解法

1. 在多网格法中,定义解误差为实际解与当前迭代解的差别。

2. 可以推导出解误差符合误差方程:Ae=R,其中R是残差项(右边-A×当前解)。

3. 将残差R从精细网格传递到粗网格,作为误差方程右边项。

4. 在粗网格上解误差方程,求解e。

5. 把e从粗网格还原回精细网格。

6. 更新迭代解u为原解加上e,得到新迭代解。

7. 多网格法中的平滑算子主要是放缓Jacobi迭代,能够有效去除振荡项。

8. 残差计算与Jacobi迭代类似,利用近邻点差分方式 Approximation。

9. 网格间传递采用简单平均法插值,从精网到粗网,从粗网回到精网。

10. 误差方程也可在粗网格递归使用多网格法求解,实现多级粗细结合。

## 33. MIT 部分微分方程数值方法第五堂课:多网格法3 -- 递归性,后平滑和测试

1. 多网格法不适用于任意网格,通常需要田字形网格,网格点之间距离为2的幂次。

2. 如果网格点不满足这一条件,前后插值运算将更加复杂。

3. 多网格法通常选择粗网格点个数是细网格的一半,但也可以适当调整比例,考虑插值运算与平滑次数的平衡。

4. 平滑次数过少会导致误差传递不准确,影响最终解。但过多也会浪费计算资源。一般需要根据方程与平滑算子选择合适次数。

5. 后平滑算子和前平滑一致,用于进一步平滑最后得出的解,使其光滑程度更高。

6. 测试结果显示,多网格法能在很少迭代次数内得到高精度解,而Jacobi迭代需要更长时间收敛。

7. 缩放因子γ的优化取值,能加快解出波数较高难在粗网格呈现的误差分量,从而提升算法效率。

8. 多网格法的递归 version 能利用更粗的网格,进一步提高计算效率。

## 34. MIT 部分微分方程数值方法第六堂课:多网格求解器代码讲解

1. 多网格法采用细网格到粗网格的多级迭代策略,能快速收敛到高精度解。

2. 每次从细网格下降到下一级粗网格前,都需要进行前平滑(如Jacobi迭代),以减少高频分量。

3. 将残差从细网格插值下降到粗网格,因为在粗网格上求解的是误差方程。

4. 在粗网格上进行平滑和残差计算,递归地求解更粗网格上的误差方程。

5. 从粗网格插值解回细网格,得到新的近似解。插值后需要进行后平滑以除去高频噪声。

6. 代码中采用递归函数,实现从最细网格递归求解各级误差方程。

7. 插值和求解误差方程均采用多个迭代,逐步提升精度,直至原线性方程。

8. 预平滑、插值、后平滑各步骤保留迭代残差方程的递归特性,实现效率提升。

## 35. MIT Numerical Methods for PDE Lecture 6: 对多网格方法工作原理的诊断

本节介绍多网格方法的工作原理。

多网格方法在计算高频数值解时采用多个网格尺寸。在较细的网格上进行平滑,计算残差;然后通过插值,将残差映射到更粗的网格上,在粗网格上进行计算;再通过插值,将粗网格解映射回细网格,并进行后平滑。重复这一过程,可以有效计算高频数值解。

设置断点可以观察多网格计算的每个阶段。初次运行时,首先停留在调用多网格方法前的断点位置。可以观察当前变量状态,当前解u仅包含高频主格信息。

继续运行后,会进入递归多网格函数内,停留在较粗网格上的断点位置。可以看到u的尺寸已经变小,表示解已经移除部分高频信息。迭代调用后,u尺寸不断变小,表示解包含的频率内容不断降低。

在三乘三的极端细网格上,仅求解一维线性方程。通过精确迭代,可以获得这个极小尺寸网格上的高精度解。

将粗网格解通过插值映射到细网格,得到误差方程e。e包含了粗网格的低频信息。将当前解u与e相加,可以重构出接近实际解的图像。

随着网格尺寸继续增大,重复上述过程,最终在原始细网格上获得最优解。多网格方法可以有效地计算高频数值解。

## 36. MIT Numerical Methods for PDE Lecture 6: W型多网格方法和Jacobi平滑运算符的收敛率

W型多网格方法与V型多网格方法相比,在更粗的网格上调用递归多网格函数的次数加倍。具体来说,通过重复调用多网格函数,可以在每个层次的网格中调用多次。

将双迭代算法改为W型,仅需将原迭代函数中的最后一行复制粘贴到下一行。这样改变会使得在爬升和下降过程中,多网格函数被调用的次数加倍。

Jacobi平滑运算符在不同细度的网格上的性质不同。在更粗的网格上,Jacobi迭代矩阵的特征值接近0,因此收敛速度很快。反之,在细grid上,特征值接近1,收敛速度较慢。

构建1D常微分方程的Jacobi迭代矩阵A。其特征值范围为(-2,-1/n),随网格点数n增加,特征值范围的最小最大值越趋于1,导致收敛速度降低。

引入重流运算可以加速收敛。其收敛速度为(1-γ)^n,γ为重流系数。选择适当的γ,可以大幅提升Jacobi迭代的收敛速度。

不同细度网格Jacobi平滑运算的性质决定了多网格方法在不同层次上的表现。这也是多网格方法对各种PDE问题高效的原因之一。

## 37. MIT Numerical Methods for PDE Lecture 6: Jacobi迭代的特征值和收敛性

Jacobi迭代的收敛速度取决于迭代矩阵的最大特征值与1的距离,以及最小特征值与-1的距离。泊松方程的迭代矩阵随网格点数n的增加,最大特征值与1的距离是1/n^2级数。

Jacobi迭代矩阵的特征值范围取决于问题尺度。对于较大问题,特征值接近-1和1,收敛较快;对于细网格问题,特征值接近1,收敛较慢。

Jacobi迭代收敛率与网格点数n成反比。如果网格点数增加一倍,收敛速度将减少4倍。

同阶松弛迭代的收敛率可以通过改变松弛参数来优化。通常选择一个能使收敛速度最大的参数值。

多网格方法在不同层次上的表现取决于在对应网格尺度下Jacobi迭代的特征值分布。基于此原理,在粗网格上进行多次迭代,可以更快地收敛到解。

在细网格上,矩阵解法如直接法比迭代法更高效,因为矩阵稀疏性下降,直接解法开销相对迭代法更低。但在并行计算中,需要考虑处理器负载均衡问题,可能需要采用不同算法。

## 38. MIT Numerical Methods for PDE Lecture 6: 高斯塞德迭代与多网格方法中的应用

高斯塞德迭代将A分解矩阵写为D+L的形式,迭代方程为D+Luks+1=b-Uuk。相比Jacobi迭代,高斯塞德迭代使用前一步算出的解来更新迭代项。

高斯塞德迭代需要解D+L矩阵,但这不难,因为D+L是下三角矩阵,可以使用前向替代法从前向后逐个求解。

相比Jacobi迭代,高斯塞德迭代收敛速度更快,在实践中很容易实现。

多网格方法中,可以使用高斯塞德迭代作为光滑运算。这有效降低了残差,比单独使用超松弛更好。

高斯塞德迭代具有序列性,需要前面位置的解来计算后面的解,这带来计算难度。Jacobi迭代依赖自身,易于并行计算。

在并行计算机或向量处理能力强的处理器上,Jacobi迭代效率较高。但从单纯循环操作看,高斯塞德迭代速度更快。

除了Jacobi和高斯塞德迭代外,还有更强大的迭代方法,如共轭梯度法、GMRES等,也可作为多网格方法中的光滑运算。

## 39. MIT Numerical Methods for PDE Lecture 6: 多网格方法中的alias错误和插值错误

在细网格向粗网格插值时,会引入别名错误。低频内容插值效果好,但高频内容插值后会产生不真实的低频模式。

例如 texture图片的细致内容在远处渲染后可能看见不真实的环形模式,这就是别名错误。

别名误差会使粗网格问题的解包含不该包含的低频模式,从而在将粗网格解插值到细网格时误增误差。

插值误差来源于将粗网格误差解采用线性插值到细网格。线性插值与理论上更好的插值之间的差异包含高频信息,称为插值误差。

后光滑运算能很好消除插值错误引入的高频内容。但后光滑不一定对多网格收敛必需,每两个网格周期前后光滑可以看作互相抵消。

调试多网格时,应检查前光滑后残差是否去除了高频内容,避免产生别名误差。后光滑能有效降低插值错误。

## 40. MIT Numerical Methods for PDE Lecture 6: 迭代法隐式求解不定周期性偏微分方程

常见不定周期性偏微分方程如:

∂u/∂t = ∂^2u/∂x^2
∂^2u/∂t^2 = ∂^2u/∂x^2

可以分时隐式离散,如后欧拉法得到:

(u_{n+1}-u_n)/Δt = a*u_{n+1}
(u_{n+1}+u_{n-1}-2u_n)/Δt^2 = a*u_{n+1}

其中a为离散算子。

上述离散方程可以使用JLRC,GS,多网格等迭代法解决。如后欧拉法得到的矩阵为:

I/Δt - a

随Δt增加趋于解像泊松方程。

∂^2u/∂t^2 = ∂^2u/∂x^2离散后为2×2矩阵,可以使用block gauss elimination变换成上三角矩阵,然后使用迭代法求解。

求解不定周期性问题时,离散网格细致程度会影响问题刚度。边界层需要更细致的网格才能求解。多网格法适用于解决问题刚度大的情况。

## 41. MIT Numerical Methods for PDE Lecture 7: 不定周期性偏微分方程的误差方程

对于不定周期性偏微分方程,可以采用分时隐式离散方法。

误差方程描述了数值解与精确解之间的关系。对于单纯移动方程∂u/∂t+∂u/∂x=0,其数值形式可以写为:

Un+1=MUn

其中M是时间发展矩阵。

若将精确解插入数值算子,将不再满足方程,这是由于数值解存在截断误差τ。

定义误差εn=Un-Uexact,n,可以得到误差方程:

εn+1=Mεn+τn

误差方程表明误差在时间上的累积:每个时间步长引入的误差τ会通过时间发展矩阵M传播到下一个时间步。

矩阵M的特征值决定误差传播的范围。M的特征值越大,误差将越快地积累。通常需要M特征值介于-1~1之间。

若M特征值大于1,误差将指数级增长,导致解发散。

需分析时间离散算子M的特征值,以判断数值差分方案的稳定性。也可以采用Neumann稳定性分析,仅考察内部点的稳定性。

## 42. MIT Numerical Methods for PDE Lecture 7: 内容稳定性分析

内容稳定性分析是一种为有限差分算法判断稳定性的方法。

将波动形状的函数插入有限差分离散算子,得到离散算子的特征值。特征值与波数的关系决定算法的稳定性。

例如考察波动方程∂u/∂t + ∂u/∂x=0的有限差分离散方程:

采用中点差分近似空间微分,向前欧拉近近似时间微分,可得到离散算子UN+1=aUN,系数a为特征值。

若试验函数为U(x,t)=U0exp(i(kx-ωt)),可求得a=(1-eik-e-ik)/2Δx

利用复指数性质,可得a为纯虚数,大于1。这表明此差分方案存在不稳定性。

若采用向后欧拉法近似时间微分,可得特征值为(1+2Δxsin(k))/Δt,处于单位圆内,表明此方案稳定。

内容稳定性分析考察各个频率下的离散算子特征值,判断稳定性不受离散网格尺寸影响,是一种有效的稳定性分析方法。

## 43. MIT Numerical Methods for PDE Lecture 7: 非线性偏微分方程的线性化与误差方程

对于非线性偏微分方程,可以通过线性化的方法进行稳定性分析。

1. 将解析解和数值解代入非线性算子相减,得出误差方程

2. 对非线性算子执行泰勒展开,近似为雅各比矩阵与误差乘积加上截断误差项

3. 要求雅各比矩阵特征值落入单位圆内,才能保证数值解随时间收敛

4. 线性化过程会引入新的误差项,但只要雅各比矩阵满足稳定条件,该误差不会累积越来越大

5. 同样的方法也适用于更高阶时间差分方案,对应的是矩阵特征值分析

6. implicit方案可能无需满足CFL条件才能保持稳定,但explicit方案一定会有CFL限制

7. 对于非线性问题,前提是误差项足够小,才能通过线性化近似非线性算子,否则需要考虑高次项影响

## 44. MIT Numerical Methods for PDE Lecture 7: 不稳定方程与混沌

对于某些描述混沌系统的非线性偏微分方程模型,其解析解可能是合理的,但其线性化方程可能是不稳定的。

这种类型的模型无法使用常规的误差分析方法,因为线性化后的误差方程可能会发散。

混沌系统描述了复杂的非线性动态行为,直接模拟其数值解往往采用不太稳定的差分方案。

但是如何通过分析求得这类混沌系统数值模拟的精度,仍处于研究阶段。这是个开放性问题。

模拟这类不稳定模型需要采用新的方法论。目前靠经验判断不同差分方案的表现,但缺乏理论支撑。

描述混沌系统的数值解稳定性分析,是非线性 diffe 方程领域一个重要且活跃的研究方向。

## 45. MIT Numerical Methods for PDE Lecture 7: 守恒定律

守恒定律是一类描述物理系统中某种物质或数量守恒的偏微分方程。

常见的守恒定律包括:质量守恒定律、能量守恒定律、动量守恒定律等。

对于任意控制体积ω,它的物质总量ρ分布随时间若无外源输入与输出,则总量保持不变。

ρ通常表示单位体积下的物质浓度,如质量浓度、动量浓度等。

守恒定律可以表示为:控制体积ω内ρ总量的变化率,等于通过边界δω输入与输出的流量差。

流量f表示通过边界δω单位时间输入或输出的ρ总量,其方向由法线指向决定。

若考虑体内源项s,如化学反应产生的ρ数量,则定律改写为输入输出流量和源项之和等于ω内ρ总量变化率。

利用高斯定理,表面积分可以转化为体积积分,从而将守恒定律写成微分方程形式,方便数值求解。

标量守恒定律研究ρ仅为标量情况,系统守恒定律ρ为向量场,如流体力学中的密度、动量和能量场等。

## 46. MIT Numerical Methods for PDE Lecture 7: 守恒、微分和积分形式;实例

守恒定律可以用三种形式表示:

1. 守恒形式:
   ∂ρ/∂t + ∇·f(ρ) = s(ρ)

2. 微分形式:
   ∂f/∂ρ · ∇ρ = s

3. 积分形式:
   d/dt∫ρdx + ∫f·nds = ∫sdx

一维情况下,∇·f等价于∂f/∂x。

线性过载波方程是典型标量守恒定律。

 burgers方程是一个非线性标量守恒定律。

Barclay-Leverett方程描述油水在多孔介质中的流动,其中u代表水分率,f代表水的流量,属于标量守恒定律。

## 47. MIT Numerical Methods for PDE Lecture 7: Burgers方程式演示

### Burgers方程

Burgers方程为 ∂u/∂t + u∂u/∂x = 0。示演示了Burgers方程的解的时间演化。

### 初始条件

标绘出了一个看起来像钟型的初值条件,用于计算Burgers方程的解。

### 時間演化

正解随时间演化,可以看到波形朝左移动和朝右移动。随着时间,不连续性形成,即激波。

### 空间时间图

显示解函数随空间和时间的演化,可以清楚看到激波的移动。

### 长期趋势

随着时间的增长,解将趋于凹平。理论上将形成两个不连续点,类似音爆的声音。

### 激波动力学

激波呈直线形式是因为两侧解函数的幅度差异。不连续面随左右解函数速度的平均速度移动。

## 48. MIT Numerical Methods for PDE Lecture 8: 项目二的澄清

### m和n的参数

m表示网格点在x方向的个数,n表示网格点在y方向的个数。第一个问题和4.1中给出了m和n,第二个问题需要输入m和n。

### 境值条件函数c

函数c表示 analytical solution,它是一个关于x,y,t的函数形式。其中a,b,c的不同组合可以表示不同的解。拉普拉斯方程的steady state解需要a=0。

### 总结问题

听众就c函数提出了是否会在顶部和底部都有峰值的问题。答疑中使用示例演示了u0=0.05时,解不是steady state,而是随时间和空间变化的波动函数。函数c的边界条件随时间变化。

### 回答问题

教授详细回答和解释了听众的疑问,帮助进一步理解c函数和边界条件,以及不同u0情况下解的形态差异。强调项目任务清晰了解m,n和c函数的含义对计算和分析结果很重要。

## 49. MIT Numerical Methods for PDE Lecture 8: 守恒定律复习

### 守恒定律的形式

守恒定律有积分形式、保守形式和原始形式三种形式。

积分形式描述定域内物质量的变化等于面积通量。保守形式利用散度定理将边缘积分转化为体积积分。原始形式通过链式法则得到。

### 意义模型问题-伯格斯方程

介绍伯格斯方程为典型的非线性守恒定律,其通量函数为u^2/2。分别给出伯格斯方程三种形式的例子。

### 解的特征

分析伯格斯方程解的特征:

1. 平稳区域内,解呈直线状,即导数为零。

2. 当解不连续时,会形成激波。激波会向特定方向以一定速度传播。

理解这两类特征,可以反推预测守恒定律方程的解。同样方法也适用于更广泛的守恒定律。

## 50. MIT Numerical Methods for PDE Lecture 8: 连续解与特征线

### 伯格尔方程的原始形式

分析伯格尔方程的原始形式:

∂u/∂t = u∂u/∂x

### 特征线

在x-t坐标系中画出特征线,特征线满足:

x = ct

其中c为特征速度,对于伯格尔方程,特征速度c = u

### 特征线沿着解不变

决定解u在特征线x=ct上的变化率du/dt。可以得到du/dt=0,即解u在特征线上保持不变。

### 连续解的预测

根据解在特征线上保持不变这一性质,可以预测出任意时刻的连续解形态。

### 通用特征线形式

上述分析对于任意守恒定律都成立。特征线通用形式为:

x = ct + x0

其中c = df/du,df/du为通量函数对解的导数。

### 特征线应用

利用特征线,可以将浸渍方程转换成微分方程集合,并分析解的变化趋势。

## 51. MIT Numerical Methods for PDE Lecture 8: 不连续解与激波

### 激波产生条件

伯格尔方程在出现∂u/∂x不存在时会出现激波,也就是解u在某点有分叉的情况。

### 方程形式失效

在激波处,微分形式和守恒形式方程都无法使用,只有积分形式方程仍然有效。

### 积分形式

积分形式为:

∫LRDt(U)+∫Lfu(U)dR=0

其中L和R包含激波处,U为区域内解集合。

### 激波速度公式

对极小控制体积求积分,可得到激波速度us等于解集合左右两侧平均值。

us=(uL+uR)/2

### 例证

以简单模型说明积分形式仍适用的原因。利用速度公式,可以预测初值条件下激波的运动轨迹。

## 52. MIT Numerical Methods for PDE Lecture 8: 弯曲激波比赛与泛用激波速度

### 赛前讨论

探讨如何构造一个仅有一个弯曲激波的初值条件,以及激波在不同区域的运动规律。

### 竞赛初值条件

竞赛参与者提出各自的初值方案,通过数值模拟验证激波的运动轨迹是否符合预期。

### 激波碰撞后的运动

两个激波碰撞后,根据特征速度平均值公式,可推知合并后的激波会向左运动。

### 一般守恒律的激波速度

对一般律式∫ULURUdx+∫LFRfdx=0进行分析,得出泛用激波速度公式:

us=(f(uR)-f(uL))/(uR-uL)

其中f(u)表示fluxfb函数,可推广到任何标量守恒律。

### 特征速度与激波速度关系

特征速度在平滑区域等于f'(u),而激波可以看作是deltaU极限趋于0的情况, zwei表征速度与特征速度一致。

## 53. MIT Numerical Methods for PDE Lecture 8: 有限体积法简介

有限体积法用于求解含不连续解的非线性守恒律方程。不同于有限差分法,有限体积法以体积作为基本单元,计算体积内函数的平均值。

守恒律方程的积分形式为体积内函数积分与体积外 fluxes 函数积分之和为0。有限体积法将域分为多个小体积,将此公式应用于每个小体积。

有限差分法记住格点函数值,有限体积法记住每个体积内函数平均值。为转化为标量微分方程组,需要用平均值重构体积interface处的解。

重构解可以表示为相邻两个平均值函数,从而得到一个flux函数。此flux函数应用于原积分方程,得到标量微分方程组。

不同有限体积方案在重构解或flux方式上有差异。但基本思路都是用平均值近似interface处解或flux,从而转化成可求解的微分方程。

## 54. MIT Numerical Methods for PDE Lecture 8: 有限体积法近似例子

有限体积法不会完全保存不连续解的形状,而是以平均值方式近似解。解会从精确的不连续变为被“模糊”的连续形式。

中心格点近似方法将体积内函数近似为相邻两个平均值的平均值。这未必完全捕获解的“一点冲击”性质。

应用此近似到布格斯方程,可以得到标量微分方程组。边界条件直接应用在第一体积的 flux 计算中。

此方法在平滑区域可工作,但在含冲击波的非线性方程中会产生不稳定振荡。这是有限体积法特有的问题,与有限差分法不同。

下一步需要探讨如何构造稳定的有限体积近似方案。方案应能准确跟踪冲击波的位置和速度,避免在解中产生人为振荡。

## 55. MIT Numerical Methods for PDE Lecture 9: 守恒定律和有限体积方法概述

有限体积方法跟踪单元平均值。它可视为单元内是常数解的近似,但实际上仅存储单元平均值。

连续解域内,解随特征线变化,即du/dt=df/du。系统出现不连续时,会形成激波,其移动速度为ΔF/Δu。

保守定律可写为三种形式:守恒形式、原始形式和积分形式。只有积分形式在有不连续情况下是可靠的。

有限体积方案根据守恒定律积分形式写出差分方程:

d/dt∫u dx = F(uI+1/2) - F(uI-1/2)

其中,单元I的平均值为:

uI=(1/Δx)∫u dx,  xI-1/2≤x≤xI+1/2

Flux F(u)在网格节点需要用数值Flux近似。这样获得离散的结构方程。

这项工作将保留解的单元平均值,从而适应解中不连续性的存在。

## 56. MIT Numerical Methods for PDE Lecture 9: 中心差分有限体积方案实现

定义网格点与单元中心点。给出布尔格斯方程的初始条件。

编写名为burgers的MATLAB函数,求解布尔格斯方程。函数输入为u,输出为du/dt。

计算单元平均值u_bar。

计算界面流量F。如果采用中心差分方案,内部界面流量为(F(u_{i-1/2})+F(u_{i+1/2}))/2。

边界条件取u=0。左侧界面流量为0,右侧界面流量为F(u_{n})。

根据有限体积方法,du/dt表示单元平均值的变化率,等于相邻界面流量差除以网格区间Δx。

将du/dt代入OD45算法,迭代求解布尔格斯方程。中心差分方案计算界面流量的这一步是该方案的特征。如果更换方案,只需修改这一步。

该函数实现了布尔格斯方程中中心差分有限体积方案的时间 discretization。

## 57. MIT Numerical Methods for PDE Lecture 9: 中心差分有限体积方案测试

定义时间步长dt为0.01。利用for循环迭代500次,每次使用OD45算法对布尔格斯方案进行时间划分。

函数burgers_ddt计算du/dt,作为OD45算法的输入。初始化条件u0采用单位圆周率的正弦函数。

利用plot命令在每个时间步绘制ui,观察解的变化情况。

最初形成了一个冲击波,但随后解出现非物理成分,解的结构变得极为振荡。

这是中心差分方案的问题所在。在冲击波形成前,有限体积方案工作正常。但形成冲击波后,解虽然保持不连续,但平滑部分产生严重振荡。

因此,中心差分方案不能适用于有强 discontinuity的问题。需要改进差分方案以提高数值稳定性。

## 58. MIT Numerical Methods for PDE Lecture 9: 上风向通量有限体积方案

中心差分方案在处理离散点时,会取中间体积平均值,从而导致界面通量不准确。

以一个例子来说明,若u左侧为1,右侧为-1,中心差分方案取体积平均值后,界面通量既不等于左侧也不等于右侧。

正确的界面通量应该只取左侧值或右侧值,这称为上风向方案。

上风向方案判断风向的依据是 du/dx ,如果 du/dx >= 0 则从左侧取值,否则从右侧取值。

du/dx 实际上可以近似看作Δu/Δx,也就是特征线的速度。

修改原有方案,使用条件判断语句,根据du/dx来判断风向,从而实现上风向差分取值。

程序运行后可以看到,采用上风向方案后,离散点保持不连续,同时解在Characteristics处渐渐消散,符合实际物理过程。

上风向方案解决了中心差分方案在处理离散点时的问题,能更好地模拟冲击波等强不连续性问题。

## 59. MIT Numerical Methods for PDE Lecture 9: 关于上风向通量有限体积方案的问答

1. 使用上风向方案后,精度仅为一阶,因为只取左右值中的一个。要达到二阶精度,需要在界面取左右值的平均值。

2. 多步进方案初始化问题,可以使用一步低精度的方案进行第一步,然后进行多步高精度迭代。

3. 上风向方案实现一阶精度的原因是仅取一侧值进行近似,需要构建重构方案以提高精度。

4. 混合使用上风向和高阶方案难度大,需要设定阈值判断进行切换。下一课将讨论使用限值器实现。

5. 错误分析可以通过线性化数值方案,研究线性误差方程的传播与累积规律。也可以求解伴随方程获取各部位误差对最终结果的影响。

6. 数值模拟中,主要关注的往往是某个物理量,如力等。通过对线性误差方案的研究可以更好地理解误差如何影响这些量。

7. 使用限值器可以在平滑区域使用高阶方案,在不连续处自动降低为一阶方案,兼顾精度和稳定性。

## 60. MIT Numerical Methods for PDE Lecture 9: 建保存方程解的不唯一性

1. 布克斯方程有两种不同的解,分别表示 discontinuity 保持不变和 discontinuity 展开。

2. 展开的解在特性线图上,characteristics 从 discontinuity 两侧发散,符合熵条件是物理可行解。

3. 保持 discontinuity 不变的解随时间保持不变,characteristics 只朝 discontinuity 流入,违反熵条件是非物理解。  

4. 物理上,只有在含粘性项的情况下,discontinuity 才具有有限厚度。无粘性情况下,discontinuity 宽度为 0,属非物理现象。

5. 上风向方案对这类问题不能很好解决,因为两侧界面通量都等于中间值,导致时间微分等于 0,只能得到停留解。

6. 熵条件从数学上说,就是 characteristics 不可能从 discontinuity 发散出来,只允许Characteristics 流入 discontinuity。

7. 只有在考虑粘性项影响的情况下,discontinuity 才能符合熵条件,属真实物理解。无粘性是特殊情况的极限。

## 61. MIT Numerical Methods for PDE Lecture 9: 雷曼问题与Burgers方程的Godonov差分方案

1. Goodenough差分方案求解雷曼问题,从而获得数值通量。

2. 雷曼问题假设细微时间下,区间两端条件固定,中间出现不连续面。

3. Burgers方程雷曼问题分四种情况:左右值同符号扩散,值异符号形成shock波等。

4. 求解接口通量时,根据不同情况选择左值或右值,或两值均值。

5. 当左值小于右值时,扩散核心值为零。接口通量也为零。

6. 数值解应满足熵条件,无法从不连续面发散出特征线。

7. Goodenough方案可以得到物理唯一解,而简单上风方案可能无法。

8. 按Goodenough方案,运动方向同的情况接近上风方案,不同的情况考虑物理性質。

9. 该方案广泛应用于多种保存律方程求解,如流体动力学等方程。

## 62. MIT Numerical Methods for PDE Lecture 10: Burgers方程的Godunov差分方案

1. Godunov方案解决雷曼问题,以求得数值通量。

2. 间隔内函数采用定值近似,存储每个 finite volume 的区域平均值。

3. Burgers方程雷曼问题分为两种情况:特征速度同向和异向扩散。

4. 特征速度同向时,通量取左右值中的一个;异向时形成shock波,通量取解前后的值。

5. 当左右值FDU符号不同,且FDU差为零时,通量为零。这时特征线呈垂直状态。

6. 通量零对应F(U)函数在U=0点的最小值,这里FDU变号,特性线方向变化。

7. 通过Godunov方案,可以获得解的数值近似,与实际解趋于一致。

8. 该方案广泛应用于描述波动和流体传输等过程的系统方程组。

## 63. MIT Numerical Methods for PDE Lecture 10: Godunov方案用于一般标量守恒定律

1. Godunov方案通过解决里曼问题来求解数值通量,采用定值近似存储每个finite volume区域的函数平均值。

2. 对标量守恒定律,里曼问题分为几种情况:特征速度同向扩散、异向扩散以及冲击波。

3. 特征速度同向时,通量取左右值中的一个;异向时形成冲击波,取解前后的值。当左右FDU符号不同且差为零时,通量为零。

4. 当uL大于uR时,通量为F(uL)的最大值;当uL小于uR时,通量为F(uR)的最小值。

5. 出现膨胀波时,通量为F在uL和uR范围内的极值点,即特征速度为零点。

6. 方案适用于任意标量守恒定律,通过解决里曼问题求得通量近似解。

7. 当F含导数时,可分离导数项与非导数项,分别处理。对线性导数项,无需复杂算法。

## 64. MIT Numerical Methods for PDE Lecture 10: Godunov方案示范

1. Godunov方案可以保证通量符合熵条件,近似求解熵满足物理解。

2. 对标量守恒定律,根据特征速度判断取左右值中的最大最小值或零通量。

3. 如果uL大于uR,通量为uL处F的最大值;如果uL小于uR,通量为uR处F的最小值,最小值可能为边界值或零。

4. 程序初始化域并设置时间步长,使用有序双层循环计算状态值。

5. 演算伯格方程,设定初值后使用Godunov方案迭代求解。Cases分别判断uL与uR的关系,取通量极值。

6. 如果F为凹函数,还需判断特征速度符号,以确定极值点。零通量需判断是否包含整个区间。

7. 演算过程中绘制解的变化,验证Godunov方案可以求得物理解。通过互动修改代码,逐步确保算法正确实现。

## 65. MIT Numerical Methods for PDE Lecture 10: Godonov方案调试和边界条件

1. 境界条件设置为0可能导致解向外推进,应设立范数点正确处理边界值。

2. 模拟方程时,添加左右端的虚点坐标,使计算范围包含整个解域。

3. 当特征速度向外时,取边界值;向内时,取内部解作为边界值。

4. 采用Godonov方案时,出现解中的不连续点,体现其一阶收敛性。加细网格会明显缩小不连续程度。

5. 排查问题时,重新运行程序,观察解域边缘值是否推进出域,是否正确取内外解作为边界条件。

6. 程序修改为在传递u数组时包含虚点,在计算交面通量时以虚点为边缘,正确运行Godunov方案。

7. 特征速度方向决定是否采用边界值或内部解,是 boundary条件处理的关键。只能在特征向内时强加边界条件。

## 66. MIT Numerical Methods for PDE Lecture 10: Second Order Finite Volume -- 重构

1. 体积平均值以及单元中心值具有二阶近似关系,体积平均值可以近似表示单元中心值。

2. 使用插值重构函数值,以二阶近似描述解域内解的分布。

3. 离散接口两侧单独重构函数值,利用体积平均仅取相应区域内信息。

4. 采用线性插值重构函数值。单元内取平均值和相邻单元中心值的差别率作为局部导数估计函数变化。

5. 将接口左右侧重构函数值当作理想流问题输入,应用Godunov方案计算通量。

6. 重构使原始一阶方法求解 upgrading到二阶,提高计算精度。但接口处依然采用离散化处理。

7. 二阶方法重构需要使用相邻单元信息,但需注意接口处解的不连续性,分离左右重构避免错误交互作用信息。

## 67. MIT Numerical Methods for PDE Lecture 10: 二阶通量重构示范

1. 根据体积平均值ULi和URi进行重构,得到离散接口两侧函数值UL和UR。

2. 线性插值法重构:ULi=0.5(Ui+Ui-1),URi=Ui+1。

3. 计算离散接口两侧的通量FLi=f(ULi),FRi=f(URi)。

4. 解Burgers方程时,接口通量取最大值;线性泡沫方程时直接取平均值。

5. 定期边界条件:解域左右两端函数值相同。

6. 用改进方案解线性泡沫方程,发现产生非物理性震动。

7. 下一步将介绍limiter限制技术,构建体积总变异量递减的有限体积方案。

8. 二阶重构需要使用相邻单元信息,但是接口处函数可能不连续,需要分开从不同区域信息进行重构。

9. 方案在Burgers方程下效果好,线性泡沫方程下更明显地出现非物理性震动问题。

## 68. MIT Numerical Methods for PDE Lecture 11: 二维有限体积方法

1. 二维守恒律方程可以写为partial u/partial t+partial fx/partial x+partial fy/partial y=0,其中fx和fy分别表示x和y方向的通量。

2. 将其积分在一个控制体积内,使用分部积分定理转换为边界条件上的积分,得到二维有限体积形式方程。

3. 控制体积可以为任意形状,如直角形、三角形等。边界面处需要近似通量平均值。

4. 采用临近单元不连续性来近似界面通量,相当于解一个一维里曼问题。

5. 需要重构多变量,如密度、动量和能量。接口通量根据变量的关系取最大最小值。

6. 实现二阶几何重构需要从相邻单元取得信息做线性插值,得到界面两侧值。

7. 项目需要实现三元体系的第一阶差分方案。重构后再应用好足协定做第二阶数值近似。

8. 二维方法的关键在于控制体积和接口通量的处理,提供了实现多维场方程的思路。

## 69. MIT Numerical Methods for PDE Lecture 11: 二维有限体积方法 - 问题与解答

1. 提问人问道是否有计算节点值和积分值的方案。回答人表示,这类方案在讲解有限元后更易理解。

2. 有限元方法中,解可以投影到各种模式上,如常量模式得体积平均值,Δ函数模式得节点值。可以混合不同模式得到各种方案。

3. 高阶多边形也可以投影到高次多项式上,这是常用的方法。

4. 对比上风和良好方案,对于标量守恒方程,良好方案通常优于上风方案,能保证熵满足解。

5. 将边分割成多个边可以提高精度。高斯正交也可以在边上取多个点近似积分,与重构配合提高精度。

6. 重构需要使用相邻单元信息。高次重构与高斯正交合用可以达到更高顺序。但单元平均值需用泰勒展开求解。

7. 结构化网格项目中,讨论的二维有限体积方法提供了实现多维场方程的思路。未来将探讨非结构化网格。

## 70. MIT Numerical Methods for PDE Lecture 11: System of Conservation Laws

### 守恒定律系统

守恒定律系统描述物理量在空间和时间上的变化,是构建数值解法的基础.

质量守恒定律可以用积分形式表示为:控制体内质量的变化等于通过入口和出口流入和流出的质量.质量通量定义为密度ρ乘以流速u.

动量守恒定律同样可以用积分形式表示,控制体内动量的变化等于通过入口和出口流入和流出的动量以及外力作用导致的变化.动量通量定义为密度ρ乘以速度u贯乘u,加上压强p的作用.

能量守恒定律表示为:控制体内能量的变化等于通过入口和出口的能量通量以及作用力做功的积分.能量通量包含物质能ρe Times u以及压强p乘以速度u的作功项.

将质量、动量和能量方程中的状态变量ρ、ρu和ρe组合成状态矢量w,可以得到系统数学形式:
partial w/ partial t + div(f(w)) = 0

其中f(w)表示状态矢量函数下的通量矢量,完全描叙了物理过程.

### 浅水方程

浅水方程描述水流动的系统守恒定律,考虑水的不可压缩性,仅包含质量和动量两个方程.

质量方程表示水体积的变化等于流入和流出的表面通量ρhu.

动量方程表示动量hu的变化等于动量通量ρhu浊u加重力产生的平均压强项1/2ρgh^2.

浅水方程适用于水流动在水深远小于水体流动尺寸的情况,是一个二维问题.

### 数值方法

守恒定律系统包含离散化后会形成耦合关系,难以用分析方法求解.数值方法提供了一种直接和有效计算分析复杂问题的方式.

常用方法有有限体积法和有限差分法。将导数用差商近似,把时间微分表示为状态变量的更新,求解过程实现状态变量在时间和空间域的迭代演化.

数值模拟结果能直观说明复杂物理问题和震波的形成演化过程,对实验又精确和成本低。是研究和理解多变量耦合问题的重要手段。

## 71. MIT Numerical Methods for PDE Lecture 11: 系统保存定律--特征线

系统保存定律方程组可以用特征线分析。若偏导矩阵为对角矩阵,则各方程解互不影响,特征线速度为对角线的值。

一般情况下,可以进行特征值分解,将系统变成多个解互不影响的子系统。特征值给出每个子系统的特征线速度和方向。

若特征值矩阵依赖变量,特征线将不是直线,可能会聚合或分离,形成类似于冲激波的行为。

特征值分析出系统各子系统的特征线速度极为重要。速度决定解从左右接口流入的方向,以及流动的快慢。

这些信息在构建接口流量模型时不可或缺。不同速度表示解来源不同,采用合适的接口模型保证计算稳定精准。

系统保存定律比脱离定律更复杂,无法直接推导特征线方程。但特征值分析给出近似,为设计数值方法提供依据。

## 72. MIT Numerical Methods for PDE Lecture 11: Upwinding and Numerical Dissipation

在求解系统守恒定律时,我们需要构造界面通量。对于WI和WI+1这两个向量,其中包含多个变量,构造其间的通量是极为复杂的。

直接求解粘滞问题十分困难。所以我们通常会采用近似粘滞方式,例如添加一定的数值粘滞。数值粘滞作用类似于物理粘滞,但不需要将粘滞限制为零。有限粘滞量可以逼近含有一定粘滞的物理解。当数值粘滞趋于零时,即网格越精细,数值解将收敛到物理强义解。

具体来说,我们利用F(WI)和F(WI+1)的平均值来近似界面通量F。此外,还添加一项数值粘滞项B×(WI - WI+1),这里B为系数。

如果F为线性形式F=uW,则B取u(风速)的绝对值,可以实现向风数值差分。此外,如果F对W的雅各比为A矩阵,则B取A特征值最大值,也可以实现向风性质。

总之,通过添加数值粘滞项D×(WI - WI+1),其中D与网格大小Δx无关,随Δx趋于0,数值粘滞也趋于0。这样可以在保证无公差的前提下,近似求解粘滞问题,实现向风数值差分。

## 73. MIT Numerical Methods for PDE Lecture 11: Numerical Dissipation Q&A, Physical Viscosity

在解决保密率方程时,需要考虑物理变量的单位。

例如,如果W的单位为m,那么F的单位应为m/s,即每单位面积每单位时间通过的保密量。

对非线性情况,可以看F对W的雅可比矩阵来确定D的值。例如如果F对W的偏导数单位为m/s,那么D也应该有同样单位。

数值粘性项D×(W1-W1+1)在Δx趋于0时也会趋于0,可以收敛到真实解。

如果考虑物理粘性μ,总通量F应为F(W)加上μ×∂W/∂x。

其中∂W/∂x使用有限差分近似,如(W1-W1+1)/Δx,保证方案仍保量。但整体通量F不使用有限差分。

只是在评估微分项时使用有限差分,以在含有物理粘性情况下,给出一个保量且考虑粘性影响的方法。

## 74. MIT Numerical Methods for PDE Lecture 11: Total Variation and Godunov Theorem on TVD Schemes

数值解法解决光滑问题时,可能产生非物理的震荡。

对于标量守恒定律,解在时间和空间间应保持总变化量不增加的性质。

总变化量定义为解在整个空间内绝对值变化的总和。对连续解,它定义为解函数的绝对梯度的积分;对不连续解,还包括脚点的绝对值。

标量守恒定律的解随时间仅沿特征线传播,不会新产生特征线。且解在特征线上的取值必已存在于初始时机。

因此,如果数值解中出现新的极值点,表明产生了非物理震荡。

总变化量不增定理表明,对线性偏微分方程,线性和第一阶精确的TVD方案是最高效的。

但如果采用非线性方式离散化,允许方案本身为非线性,那么可以构造任意高阶而又是TVD的数值方案。这就需要使用限制器这种非线性机制。

## 75. MIT Numerical Methods for PDEs Lecture 12: Need for Flux Limiter

对线性标量守恒定律使用有限体积法,直接求解或通过线性重构都会出现非物理震荡。

重构中的额外polation可能导致数值解超出解析解的最大或最小值范围,从而产生新极值点。

这是因为在不连续处或局部极值点进行重构时,相邻单元的信息可能引入错误。

限器的作用是根据解的本地特征,选择使用重构还是定值近似。

如果检测到局部极值点,则采用定值近似;如果检测到区域平滑,则采用重构。

限器设计的主要原则是:

1. 根据解的本地特征选择方案

2. 以连续方式切换方案,避免出现不连续点造成的误差

3. 保持方案的一阶精度

利用限器,可以在保持TVD特性的同时,实现高于一阶的准确性。这就是非线性机制对线性问题的重要性。

## 76. MIT Numerical Methods for PDEs Lecture 12: How does Flux Limiter work

限器(Flux Limiter)用来决定在解的不同区域选择使用重构还是定值近似。

限器的输入为相邻两单元的量UI和UI±1,输出为修正因子φ,以控制重构的角度。

定义φ为 UI - UI-1 与 UI+1 - UI之比R的函数:

φ = f(R)

R = (UI+1 - UI) / (UI - UI-1)

对R的取值范围作如下约束:

1. R=1时,φ=1,即保持二阶精度

2. R<0时,φ=0,即采用定值近似

3. 重构不得超过下下标单元值

4. 重构斜率不得超过相邻单元斜率的2倍

这些约束划分出φ-R可取值域的区域。

在此区域内选择φ函数,即实现了根据解特性自动调整重构角度,兼顾TVD性和高于一阶精度。

限器机制通过非线性方式,可以解决线性问题使用须加图引入的瑕疵,从而获得更高准确性。

## 77. MIT Numerical Methods for PDEs Lecture 12: Examples of Flux Limiters

限器的输入为相邻两单元的量UI和UI±1,输出为修正因子φ,以控制重构的角度。

φ取决于量UI和UI±1之比R:

φ = f(R)

R = (UI+1 - UI) / (UI - UI-1)

典型限器包括:

1. 最小模限器(Minmod Limiter)

    f(R) = {0, R, 1}

    取最保守的重构。

2. 最大模限器(Superbee Limiter)  

    f(R) = {0, R, 2, 1}

    取最激进的重构。

3. Van Leer限器

f(R) = 2R/(1+R)

平衡最小模限器和最大模限器的特性。

以上限器都是非线性函数,可以根据解的特征灵活调整重构程度,同时满足TVD性和二阶精度要求。

## 78. MIT Numerical Methods for PDEs Lecture 12: Unstructured mesh in Finite Volume

有以下优点:

1. 可以处理任意形状的不规则网格。

2. 只需在每单元体内估计解函数,不需要估计导数。

3. 通过求解每个单元的通量差,实现对偏微分方程的离散。

适用于各种不规则网格,如折线网格、自适应网格等。

在不规则网格中,单元体的贡献计算为:

境界面的通量差之和= 净通入通量 - 净通出通量

计算每个单元体内解函数的体积平均值。

无论单元体形状和边界数量如何,原理都一样。这对处理复杂几何形状很有利。

## 79. MIT Numerical Methods for PDEs Lecture 12: Unstructured mesh in Matlab

使用Matlab的PDE工具箱可以绘制和处理不规则网格。

可以绘制任意形状的网格,并提取顶点、边界和内部边的数据。

计算每个单元接口面的法向向量。法向向量用于计算通量在接口面的投影。

在有限体积法中,需要循环计算每个单元的自通量。

然后再循环计算每个接口面上的通量。为保证守恒,每个接口面上的通量只需要计算一次。

计算通量后,立即将其添加到一个单元,从另一个单元减去。这样就实现了数值上保持总量守恒。

循环计算完所有接口面的通量后,整个混合体内总量就保持不变,除开边界上的接口面。

## 80. MIT Numerical Methods for PDEs Lecture 12: Flux Limiter Demo

继续改进高阶量差分方法中的重构步骤。

保留以前使用的Goodenough方案计算通量。

计算R值时,UL值左边接口的U值应使用I+2位置,而不是I+1位置。

定义线性限流函数linear(r),根据R值的大小返回φ值。

如果R为NaN或无限大,φ取1。

重构UL和UR值时,都需要使用线性限流函数linear(r)乘以 Reconstruction项。

计算UL时,R值计算使用u(i+1)-u(i),计算UR时使用u(i)-u(i-1)。

实现重构和限流逻辑后,需要运行代码测试是否正确。但由于时间原因,未在课堂上进行测试。

下节课将测试改进后的代码是否能修正原有方法中的擦除问题。

## 81. MIT Numerical Methods for PDE Lecture 13: Flux limiter review and demo

限流器的作用是在重构阶段引入非线性,使线性方程的数值解也能限制极值。

有限体法对解进行定主跳跃近似,重构试图将体积平均值推断到界面。限流器决定重构是否适用于解光滑连续的区域。

计算R值时,应取UI+1-UI除以UI-UI-1,因为是重构UI+1/2界面。

MUSCL限流器中,如果R≤0,φ=0;如果R有限,φ=2R/(R+1)。当R无限时,φ取为2。

修改限流器函数后,验证代码是否能修正原问题。如采用Venkatakrishnan限流器,波形将更尖锐。

限流器引入非线性后,数值解将不会超过或低于初始条件的极值,且还保持二阶精度。不同限流器仅需改变φ函数即可。

## 82. MIT Numerical Methods for PDE Lecture 13: Flux limiter and Finite Volume Q&A

有限差分和有限体法中,不会重建连续解函数,只在特定点或体积平均值中考察解函数值。

在边界重建时,如果已知边界条件值,直接使用;如果特征向外,则使用内点值计算边界流,无需重建。

计算边界流时,如果特征向内,可使用边界值和第一体积平均值构造梯度;如果向外,使用内点riemann解,禁止使用边界值构造梯度。

系统方程中的不同特征可能向内或向外,边界重建需谨慎处理,不宜使用边界值直接重建解。

## 83. MIT Numerical Methods for PDE Lecture 13: Introduction to Finite Element

有限元素法从微分方程的弱形式入手进行离散化,弱形式需要通过投影的概念来理解。

投影意指函数在有限子空间内的最佳近似,子空间常采用段式线性基。

有限差分记忆网格点函数值,有限体法记忆体积平均值,有限元素法通过最小化积分平方距离,求函数在段式线性子空间内的最佳近似。

此近似看成是连续函数与段式线性函数之间“弹簧”的最小能量状态,强加限制条件为连续或允许不连续。

## 84. MIT Numerical Methods for PDE Lecture 13: Finite Element -- Intro to projection

有限元法从函数的投影获取概念。投影是函数在有限子空间内的最佳近似。子空间常采用段式线性基。

投影将函数从无限维空间投射到有限维空间内。条件是投影要在子空间内,且距离原函数最近。

此投影类似三维物体在二维平面上的投影。最小化投影与原函数差异 Integral 的积分来求最佳近似。

将函数f(x)投影到子空间Xh内。Xh元素为段式线性且连续的函数。可以用有限个基函数来表示。

如果将区间分割为三段,则基函数有4个:分别对应每个区间的值。任意段式线性连续函数都可表示为这4基函数的线性组合。

所以该函数空间为4维空间。如果区间有100段,基函数就有101个,空间维度为101。通过基函数来用有限个浮点数表示任意函数。

有限差分只记录区间点值,而有限元素通过基函数表示间值。这使得有限元素方法比有限差分更深入函数的属性。

## 85. MIT Numerical Methods for PDE Lecture 13: More on Projection

有限元法有多个选择的有限维子空间。

第一种子空间选择段式线性且连续基函数。如果将区间分为3段,则基函数有4个,构成4维空间。

第二种子空间选择段式线性但允许断 continuity 的基函数。例如3段时,基函数有6个,构成6维空间。

其它选择还有用多项式或正弦余弦函数作为基函数。这会构成不同维度的空间。

一般来说,区间段数越多,基函数越多,子空间维度越高。但选择合适基函数更重要。

有限元素方法也适用于多维情况。例如二维时可以用三角形划分,三维四面体划分,构建本地线性基函数。

对不规则网格,有限元素更易实现。结构网格需要考虑二次等函数,计算更复杂。

子空间选择广泛,本课主要介绍易于推广且计算简单的段式线性连续基函数。它在多维情形下也有很好用途。

## 86. MIT Numerical Methods for PDE Lecture 13: A different mathematical representation of projection

有限元素方法可以将微分方程投影到有限维子空间,找到子空间内解的近似解。

将微分方程视为要满足的条件,要求该条件在子空间内的误差最小。具体来说,求解微分方程u使得方程左右两边之差的模平方积最小。

这个最小化问题的解u称为投影。它具有如下性质:

对任意在子空间内的微小变换Δg,都有以下不等式成立:

∫(u−f)2+Δg2+2Δg(u−f) dx ≥ ∫(u−f)2 dx

当Δg趋于0时,上式只能成立如果以下条件满足:

∫Δg(u−f) dx = 0

即投影u与原函数f之间的差,在任何子空间方向上的内积都为0.

这解释了投影在意义上是使误差在子空间的正交补充空间为0。也就是说,投影后的误差向量与子空间都成正交。

该数学形式揭示了投影在子空间内寻找使误差最小化的数学原理。

## 87. MIT Numerical Methods for PDE Lecture 13: 投影与有限元素解决波随方程

波随方程的余条为Delta函数与其他函数的叠加,这与常规函数不同。

投影操作的定义为:将残差函数与任意测试函数内积设置为0。

可将内积写为积分形式,将残差函数与测试函数的乘积进行积分,设置为0。

利用积分换元公式将二阶导数项转化为边界项与一阶导数项。

这样就将波随方程投影到有限维函数空间,得到有限元素解决方程。

将测试函数取离散基函数的线性组合,则内积方程转化为有限组线性方程。

将解函数也用基函数的线性组合表示,带入线性方程组就得到解的系数方程。

利用矩阵法计算各个基函数的系数,从而求解波随方程的有限元素近似解。

总之,利用投影原理将微分方程转换为有限维线性问题,并用基函数展开解与测试函数,得到可以数值求解的矩阵方程。

## 88. MIT Numerical Methods for PDE Lecture 13: 投影法和有限元法问答

有限元法需要在近似空间和残差空间选择同样的基函数空间。

若近似空间和残差空间基函数不同,可能导致方程个数和未知数个数不匹配,进而 Matrix 非奇异性无法保证。

需要考虑边界条件影响基函数选择。Dirichlet 边界条件可以排除部分基函数,降低近似空间维度。

附加边界条件后,方程组可能转变为正定,Matrix 不再奇异。

最佳投影要求近似空间等于残差空间。符合要求时,基函数个数应与未知数个数一致,可求得非奇异解。

但即使基函数匹配,方程本身非奇异性也需考虑。仅满足投影要求不能完全排除 Matrix 奇异可能。

提问环节中纠正学生误区,阐释有限元算法数学原理,帮助学生深入理解该方法在PDE求解中的应用。

## 89. MIT Numerical Methods for PDEs Lecture 14: Finite Element for Poissons Equation in 2D

我们在上一课介绍了有限元法的概念,将无限维空间投影到有限维空间。今天我们来详细介绍二维情况下的有限元解法氏方程的实现。

考虑一个二维空间Ω,我们要解决的泊松方程是:

Δu = f

其中Δ是拉普拉斯算子,等价于∇^2u=掐v(∇u)=f。

有限元法分两步:

1. 把解空间u限制在一个有限维函数空间Xh中。Xh是由三角形网格划分Ω后,每个三角形内函数线性的连续不连续函数空间。

2. 将残差∇^2u-f投影到Xh中,使得对任意V∈Xh都满足:

∫_(Ω)(∇^2u-f)VdΩ=0

通过变分法和 Greens公式,可以将上式变换为给定u于边界Ω为0的形式。

构建Xh空间时,我们知道如果三个点的值确定,则可以唯一定义二维三角形内的线性函数。同理,可以构建Xh中的基函数。

最后,我们得出包含u解在Xh中的矩阵方程形式,并通过数值法求解。这实现了二维情况下的有限元法。

## 90. MIT Numerical Methods for PDEs Lecture 14: Finite Element for Poissons Equation in 2D continued

视频继续介绍了有限元法在二维情况下解偏微分方程的实现细节:

1. 将格林公式应用在投影后的泊松方程上,可以获得弱形式方程。弱形式通过分部积分,降低对解函数u的微分顺序要求。

2. 构建基函数空间Xh。考虑由三角形网格划分的计算区域,如果可以确定三角形内每个节点的函数值,则可以唯一定义该三角形内的线性函数。利用每个节点单独取1其余节点取0的基函数,则可以构成Xh空间。

3. 将u和v写为Xh基函数的线性组合。将弱形式方程中u和v替换,得到仅与基函数系数有关的矩阵方程。

4. 矩阵方程左侧包含双索引I,J形式的积分项,右侧单索引J形式的向量项。求解基函数系数,即求解该矩阵方程。

5. 矩阵和向量项中的积分可以事先计算得到,最后通过数值方法求解线性方程组,获得解u在每个节点的值,从而完整求解问题。

通过这一过程,将泊松方程问题放在有限维Xh空间中求解,实现了二维情况下的有限元方法。

## 91. MIT Numerical Methods for PDEs Lecture 14: Finite Element for Poissons Equation Demo 1D

视频演示了一维情况下有限元方法求解泊松方程的具体实现步骤:

1. 生成随机乱序的节点点集合作为网格,取节点点为0和1作为边界条件。

2. 定义单元内互斥支持的基函数组成基函数空间。

3. 计算基函数梯度内积矩阵K,其中对角线元素为相邻两个单元梯度内积总和,非对角线元素为相邻单元梯度内积。

4. 计算右端向量B,其中每个元素为基函数在整个求解域内的积分。

5. 通过求解自由度矩阵方程Ku=B,得到节点点函数值组成的解向量u。

6. 添加边界点函数值,绘制数值解与解析解对比。

7. 泊松方程解析解为fx=-x(1-x),通过大量采样点绘制approximate解与数值解,验证方法正确性。

实现过程中计算细节如单元宽度、基函数梯度等都给出详细推导,演示了一维情况下有限元方法的原理及实现。

## 92. MIT Numerical Methods for PDEs Lecture 14: Finite Element for Poissons 2D Matlab Demo: Preparation

本视频展示如何用Matlab实现有限元素方法解二维泊松方程的具体准备工作。

首先使用OD2子程序创建一个三角形网格,得到节点点位置数组p和三角形连接数组t。t的前三行表示每个三角形对应的三个节点在p中的索引,最后一行表示三角形所属的区域。

接着定义基函数梯度矩阵g,其大小为三角形数×3(每个三角形3个节点)×2(x,y方向)。对每个三角形k,计算其三个节点p1,p2,p3的坐标,构成矩阵dx。通过dx映射求解基函数在该三角形内的梯度g。

然后定义方程矩阵k, initially为三角形节点数目×三角形节点数目大小。将逐步对k进行迭代式增加,记录每个三角形k对矩阵的贡献。

contribution为三角形面积和基函数梯度的积分。面积需要进一步计算。

最后指出k矩阵的大小应为三角形节点数目,因为系数矩阵记录的是各节点之间的关系,而不是三角形。这次准备工作为后续求解方程打下了基础。

## 93. MIT Numerical Methods for PDEs Lecture 14: Finite Element for Poissons 2D Matlab Demo: Execution

首先计算每个三角形元素的面积a。面积由三个节点点坐标构成矩阵dx的行列式计算得出,取值的一半。

接着初始化方程系数矩阵k和源项向量b的大小。k大小为三角形节点点数目,b大小为节点点数目。

然后为方程矩阵k赋值。遍历每个三角形元素,计算其三个节点i1,i2,i3对应的梯度矩阵gk。将三角形面积a乘以gk列向量内积分量,相加累加到对应的k矩阵位置。

具体是:对每个三角形元素,内循环计算其三个节点对之间的关系。将面积a乘以节点i和节点j梯度内积,相加累加到k矩阵ik,jk位置。采用这样逐渐累加的方式,可以避免重复计算部分关系。

源项b也采用相同原理,将三角形面积a的三分之一累加到对应的节点位置。

这样就完成了复杂三角形网格下的有限元方程矩阵k和源项b的求解。

## 94. MIT Numerical Methods for PDEs Lecture 15: Math Foundation of Finite Element: function spaces

函数空间指一个集合内的所有函数。

一个向量空间X需要满足:

1. 对任意a,b,c在X内,则a+b也在X内

2. 对任意a在X内,λ为实数,则λa也在X内

3. a+b=b+a

主要讨论实数域下的向量空间。

L2空间:函数f在定义域上积分绝对值平方可微。

H1空间:函数f和其一阶导数在定义域上积分绝对值平方可微。

举例说明:

1/x 不在L2空间内,原因是在0点附近积分值为无限。

1/(x+1) 在L2和H1空间内。

√x/(x+1) 在L2空间内但不在H1空间内,原因是在0点一阶导数积分值为无限。

函数空间定义时考虑函数本身及其导数的性质,通过规定函数及导数在定义域内的正则条件,来判断函数是否在特定空间内。这对有限元方法理解误差估计及求解都很重要。

## 95. MIT Numerical Methods for PDEs Lecture 15: 数值方法与偏微分方程的数学基础: 函数意

在有限元分析中,我们常使用线性函数和双线性函数。

线性函数是一个定义在函数空间上的函数,它可以将一个函数映射成一个实数。线性函数具有线性性,即:

1. 对任意函数f,若将f乘以一个系数α,那么对函数f作用线性函数也等于将结果乘以α;

2. 对任意两个函数f和g,线性函数作用在f+g上等于作用在f上加上作用于g上的结果。

常见的线性函数有积分、函数在某点的值、函数在某点的导数等。

双线性函数与线性函数类似,但它作用于两个函数上,且对两个函数都需满足线性性,具体为:

1. 对任一函数f,若将f乘以α,那么双线性函数作用于f和另一个函数上的结果等于α乘以原来的结果;

2. 对任一函数g,若将g乘以α,那么双线性函数作用于第一个函数和g上的结果等于α乘以原来的结果;

3. 对两个函数f和g的和,双线性函数作用等于作用于f和g上的结果之和。

例如双线性形式就是一种重要的双线性函数。

函数空间内的范数也是一个线性函数,但它不满足复合线性性质。另一个重要概念是线性算子的范数,它衡量线性算子的“规模”。线性算子范数的定义是最小使得所有函数f满足条件的常数。

## 96. MIT Numerical Methods for PDEs Lecture 15: 数值方法与偏微分方程的数学基础: PDEs的弱形式

在定义PDEs的弱形式时,需要定义一个函数空间X。例如考虑单变量情况下的区间[0,1],定义函数空间X为H1([0,1])。

然后定义一个线性形式L和双线性形式B。例如:

L(f) = ∫01 f(x)dx
B(f,g) = ∫01 (∂f/∂x)*(∂g/∂x) dx

它们满足有界性条件。

PDEs的弱形式定义为对所有f∈X,:

B(f,g) = L(f)

通过积分部分积分,可以得到PDE的弱形式等价于一个模型方程加上边界条件。

边界条件分为本 essential Boundary 条件和自然Boundary条件。

- 本essential Boundary条件通过限制函数空间来强制实现,如取X为H1([0,1])∩{f=0 on ∂Ω}

- 自然Boundary条件自然出现在弱形式中,如上例中得到的∂g/∂x|∂Ω=0。

弱形式框架为有限元素解PDE提供了数学基础。

## 97. MIT Numerical Methods for PDEs Lecture 15: 有限元的数学基础:自然边界条件

### 新曼边界条件

新曼边界条件表示函数在边界上的梯度方向的导数值被规定。

在弱形式中,双线性形式不需要修改,还是等于内部梯度的积分。但线性形式需要加入边界项,体现新曼边界条件。

线性形式更新为:

L(v) = ∫Ω -vfdΩ + ∫Γ avdΓ  

其中,a 为边界条件函数。

### 罗宾边界条件

罗宾边界条件表示函数在边界上的正常导数等于函数本身加线性函数之和。

在弱形式中,双线性形式不变。线性形式需要加入两个边界项:

L(v) = ∫Ω -vfdΩ + ∫Γ (a+bu)vdΓ

其中,a 为常数项,b 为函数项系数。

### 总结

通过积分分部得到弱形式中的边界项,与线性空间中任意测试函数v的乘积相等,从而推导出边界条件在弱形式中的表达方式。

这种方法称为自然边界条件,能够将强形式中的边界条件自然引入弱形式。对于某些边界条件,还需要采用本质边界条件强制约束解函数空间。

## 98. MIT Numerical Methods for PDEs Lecture 15: 有限元的数学基础:本质边界条件

### 非零边界条件

如果边界条件为非零值,比如u=uB,则无法通过修改双线性形式和线性形式来满足这个边界条件。

### 函数投影

定义一个函数投影空间XH,将高维函数F投影到XH中,满足边界条件u=uB形成一个非线性空间XHB。

其中:

- XH是线性空间
- F是高维函数
- XHB是非线性空间,满足边界条件限制

投影定义为:FH是XH中的元素,使得F-FH与XH中的任意u-FH正交。

### 弱形式定义

弱形式定义为:双线性形式A(u,v)=L(v),其中:

- u∈XHB
- v∈XH0,是XH同质化空间
- 满足边界条件限制

通过投影,将非零边界条件问题转换为本质边界条件问题求解。这种方法称为本质边界条件方法。

## 99. MIT Numerical Methods for PDEs Lecture 16: 从弱形式到有限元

### 弱形式

弱形式定义为双线性形式A(u,v)等于线性形式L(v),其中:

- u属于空间Xp
- v属于空间X

### 有限元方法

1. 从无限维空间X和Xp选择有限维子空间XH和XHB

2. 将u和v分别限制在XH和XHB内

3. 保留原来的双线性形式A和线性形式L不变

4. 求解时只需要让等式对XH中的基函数满足

5. 这样问题就变成有限个方程与变量的线性系统了

### 选择有限维子空间

选择不同的XH和XHB可以得到不同的有限元素类型,如连续线性元素或离散线性元素。

### 空间中的元素

空间中的元素可以表示成基函数的线性组合,这样问题就转成求解基函数系数了。

### 具体实现

将讨论不同类型偏微分方程(静态、不 steady)的具体有限元素实现细节。

## 100. MIT Numerical Methods for PDEs Lecture 16: 高斯积分法

### 弱形式的线性与双线性项

任何线性微分方程经过求弱形式后,都包含线性项和双线性项。

- 线性项只与测试函数有关
- 双线性项与测试函数和解函数都有关

### 线性项的求值

线性项是一个积分,包含测试函数与等式右边的函数。

积分可分解为每个元素上的积分求和。此时函数内部均匀,可使用高斯积分法求解。

### 高斯积分法

用一组预定点与权重近似求积分,相比手动积分更快更精确:

- 对多项式精确,对光滑函数近似很好
- 点数越多,近似误差越小
- MATLAB内置函数可以求解点与权重

### 具体实现

1. 将线性项分解为各元素积分
2. 在每个元素内,函数均匀,使用高斯积分求解
3. 得到线性项对每个基函数的数值近似

高斯积分法是数值积分的首选方法。
